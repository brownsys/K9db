Loading: 
Loading: 0 packages loaded
DEBUG: /home/pelton/.cache/bazel/_bazel_pelton/97604a07e7404c938be38d9695199862/external/rules_python/python/repositories.bzl:8:10: py_repositories is a no-op and is deprecated. You can remove this from your WORKSPACE file
Analyzing: target //mysql_proxy/src:mysql_proxy (0 packages loaded, 0 targets configured)
WARNING: /home/pelton/pelton/pelton/planner/calcite/src/com/brownsys/pelton/BUILD.bazel:3:12: in srcs attribute of java_binary rule //pelton/planner/calcite/src/com/brownsys/pelton:QueryPlanner: please do not import '//pelton/planner/calcite/src/com/brownsys/pelton/nativelib:DataFlowGraphLibraryConfig.java' directly. You should either move the file to this package or depend on an appropriate rule there. Since this rule was created by the macro 'java_binary', the error might have been caused by the macro implementation
INFO: Analyzed target //mysql_proxy/src:mysql_proxy (0 packages loaded, 0 targets configured).
INFO: Found 1 target...
[0 / 1] [Prepa] BazelWorkspaceStatusAction stable-status.txt
Target //mysql_proxy/src:mysql_proxy up-to-date:
  bazel-bin/mysql_proxy/src/mysql_proxy
INFO: Elapsed time: 0.565s, Critical Path: 0.00s
INFO: 1 process: 1 internal.
INFO: Build completed successfully, 1 total action
INFO: Running command line: bazel-bin/mysql_proxy/src/mysql_proxy '--logtostderr=1'
INFO: Build completed successfully, 1 total action
I1213 01:40:05.474190 30816 state.cc:25] Starting dataflow worker 2
I1213 01:40:05.474247 30815 state.cc:25] Starting dataflow worker 1
I1213 01:40:05.474253 30814 state.cc:25] Starting dataflow worker 0
I1213 01:40:05.521498 30489 executor.cc:59] Shard: default
I1213 01:40:05.521608 30489 executor.cc:107] Statement: CREATE TABLE default_db_users (id INT NOT NULL PRIMARY KEY, PII_username VARCHAR(100) UNIQUE, email VARCHAR(100), password_digest VARCHAR(100), created_at DATETIME, is_admin INT, password_reset_token VARCHAR(100), session_token VARCHAR(100) NOT NULL, about VARCHAR(100), invited_by_user_id INT REFERENCES default_db_users(id), is_moderator INT, pushover_mentions INT, rss_token VARCHAR(100), mailing_list_token VARCHAR(100), mailing_list_mode INT, karma INT NOT NULL, banned_at DATETIME, banned_by_user_id INT REFERENCES default_db_users(id), banned_reason VARCHAR(100), deleted_at DATETIME, disabled_invite_at DATETIME, disabled_invite_by_user_id INT REFERENCES default_db_users(id), disabled_invite_reason VARCHAR(100), settings VARCHAR(100)) ENGINE ROCKSDB
Dec 13, 2021 1:40:05 AM com.brownsys.pelton.QueryPlanner plan
INFO: planning query
SELECT id, user_id FROM comments WHERE id = ?
Warning: Could not load Loader: java.lang.UnsatisfiedLinkError: no jnijavacpp in java.library.path: [pelton/planner/calcite/src/com/brownsys/pelton/nativelib/]
Warning: Could not load Pointer: java.lang.UnsatisfiedLinkError: no jnijavacpp in java.library.path: [pelton/planner/calcite/src/com/brownsys/pelton/nativelib/]
Warning: Could not load BytePointer: java.lang.UnsatisfiedLinkError: no jnijavacpp in java.library.path: [pelton/planner/calcite/src/com/brownsys/pelton/nativelib/]
SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: Unoptimized plan
LogicalProject(id=[$0], user_id=[$5])
  LogicalFilter(condition=[=($0, ?0)])
    LogicalTableScan(table=[[comments]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: optimized plan
LogicalProject(id=[$0], user_id=[$5])
  LogicalFilter(condition=[=($0, ?0)])
    LogicalTableScan(table=[[comments]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: Added all operators
[
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ] ],
  "output_columns": [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ] ],
  "output_columns": [ "id","user_id" ],
 },
 {
"operator": "MAT_VIEW", "id": 2, "children": [ ],
  "input_columns": [ [ "id","user_id" ] ],
  "output_columns": [ "id","user_id" ],
  "keyed_by": [0],
  "order": "no order",
 },
]
I1213 01:40:07.224228 30489 graph.cc:103] Planned exchanges and partitioning of flow
I1213 01:40:07.224253 30489 graph.cc:104] [
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ] ],
  "output_columns": [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ] ],
  "output_columns": [ "id","user_id" ],
 },
 {
"operator": "MAT_VIEW", "id": 2, "children": [ ],
  "input_columns": [ [ "id","user_id" ] ],
  "output_columns": [ "id","user_id" ],
  "keyed_by": [0],
  "order": "no order",
 },
]
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: planning query
SELECT short_id, user_id FROM comments WHERE short_id = ?
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: Unoptimized plan
LogicalProject(short_id=[$3], user_id=[$5])
  LogicalFilter(condition=[=($3, ?0)])
    LogicalTableScan(table=[[comments]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: optimized plan
LogicalProject(short_id=[$3], user_id=[$5])
  LogicalFilter(condition=[=($3, ?0)])
    LogicalTableScan(table=[[comments]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: Added all operators
[
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ] ],
  "output_columns": [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ] ],
  "output_columns": [ "short_id","user_id" ],
 },
 {
"operator": "MAT_VIEW", "id": 2, "children": [ ],
  "input_columns": [ [ "short_id","user_id" ] ],
  "output_columns": [ "short_id","user_id" ],
  "keyed_by": [0],
  "order": "no order",
 },
]
I1213 01:40:07.240161 30489 graph.cc:103] Planned exchanges and partitioning of flow
I1213 01:40:07.240200 30489 graph.cc:104] [
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ] ],
  "output_columns": [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ] ],
  "output_columns": [ "short_id","user_id" ],
 },
 {
"operator": "MAT_VIEW", "id": 2, "children": [ ],
  "input_columns": [ [ "short_id","user_id" ] ],
  "output_columns": [ "short_id","user_id" ],
  "keyed_by": [0],
  "order": "no order",
 },
]
I1213 01:40:07.244933 30489 executor.cc:59] Shard: default
I1213 01:40:07.244985 30489 executor.cc:107] Statement: CREATE TABLE default_db_invitation_requests (id INT NOT NULL PRIMARY KEY, code VARCHAR(100), is_verified INT, PII_email VARCHAR(100), name VARCHAR(100), memo VARCHAR(100), ip_address VARCHAR(100), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL) ENGINE ROCKSDB
I1213 01:40:07.260077 30489 executor.cc:59] Shard: default
I1213 01:40:07.260177 30489 executor.cc:107] Statement: CREATE TABLE default_db_keystores (keyX VARCHAR(100) NOT NULL PRIMARY KEY, valueX INT) ENGINE ROCKSDB
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: planning query
SELECT id, user_id FROM read_ribbons WHERE id = ?
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: Unoptimized plan
LogicalProject(id=[$0], user_id=[$4])
  LogicalFilter(condition=[=($0, ?0)])
    LogicalTableScan(table=[[read_ribbons]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: optimized plan
LogicalProject(id=[$0], user_id=[$4])
  LogicalFilter(condition=[=($0, ?0)])
    LogicalTableScan(table=[[read_ribbons]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: Added all operators
[
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","is_following","created_at","updated_at","user_id","story_id" ] ],
  "output_columns": [ "id","is_following","created_at","updated_at","user_id","story_id" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","is_following","created_at","updated_at","user_id","story_id" ] ],
  "output_columns": [ "id","user_id" ],
 },
 {
"operator": "MAT_VIEW", "id": 2, "children": [ ],
  "input_columns": [ [ "id","user_id" ] ],
  "output_columns": [ "id","user_id" ],
  "keyed_by": [0],
  "order": "no order",
 },
]
I1213 01:40:07.290652 30489 graph.cc:103] Planned exchanges and partitioning of flow
I1213 01:40:07.290673 30489 graph.cc:104] [
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","is_following","created_at","updated_at","user_id","story_id" ] ],
  "output_columns": [ "id","is_following","created_at","updated_at","user_id","story_id" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","is_following","created_at","updated_at","user_id","story_id" ] ],
  "output_columns": [ "id","user_id" ],
 },
 {
"operator": "MAT_VIEW", "id": 2, "children": [ ],
  "input_columns": [ [ "id","user_id" ] ],
  "output_columns": [ "id","user_id" ],
  "keyed_by": [0],
  "order": "no order",
 },
]
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: planning query
SELECT id, user_id FROM stories WHERE id = ?
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: Unoptimized plan
LogicalProject(id=[$0], user_id=[$2])
  LogicalFilter(condition=[=($0, ?0)])
    LogicalTableScan(table=[[stories]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: optimized plan
LogicalProject(id=[$0], user_id=[$2])
  LogicalFilter(condition=[=($0, ?0)])
    LogicalTableScan(table=[[stories]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: Added all operators
[
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","user_id" ],
 },
 {
"operator": "MAT_VIEW", "id": 2, "children": [ ],
  "input_columns": [ [ "id","user_id" ] ],
  "output_columns": [ "id","user_id" ],
  "keyed_by": [0],
  "order": "no order",
 },
]
I1213 01:40:07.307312 30489 graph.cc:103] Planned exchanges and partitioning of flow
I1213 01:40:07.307333 30489 graph.cc:104] [
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","user_id" ],
 },
 {
"operator": "MAT_VIEW", "id": 2, "children": [ ],
  "input_columns": [ [ "id","user_id" ] ],
  "output_columns": [ "id","user_id" ],
  "keyed_by": [0],
  "order": "no order",
 },
]
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: planning query
SELECT short_id, user_id FROM stories WHERE short_id = ?
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: Unoptimized plan
LogicalProject(short_id=[$6], user_id=[$2])
  LogicalFilter(condition=[=($6, ?0)])
    LogicalTableScan(table=[[stories]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: optimized plan
LogicalProject(short_id=[$6], user_id=[$2])
  LogicalFilter(condition=[=($6, ?0)])
    LogicalTableScan(table=[[stories]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: Added all operators
[
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "short_id","user_id" ],
 },
 {
"operator": "MAT_VIEW", "id": 2, "children": [ ],
  "input_columns": [ [ "short_id","user_id" ] ],
  "output_columns": [ "short_id","user_id" ],
  "keyed_by": [0],
  "order": "no order",
 },
]
I1213 01:40:07.321256 30489 graph.cc:103] Planned exchanges and partitioning of flow
I1213 01:40:07.321276 30489 graph.cc:104] [
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "short_id","user_id" ],
 },
 {
"operator": "MAT_VIEW", "id": 2, "children": [ ],
  "input_columns": [ [ "short_id","user_id" ] ],
  "output_columns": [ "short_id","user_id" ],
  "keyed_by": [0],
  "order": "no order",
 },
]
I1213 01:40:07.322511 30489 executor.cc:59] Shard: default
I1213 01:40:07.322557 30489 executor.cc:107] Statement: CREATE TABLE default_db_tags (id INT NOT NULL PRIMARY KEY, tag VARCHAR(100) NOT NULL UNIQUE, description VARCHAR(100), privileged INT, is_media INT, inactive INT, hotness_mod INT) ENGINE ROCKSDB
I1213 01:40:07.373365 30489 executor.cc:59] Shard: default
I1213 01:40:07.373415 30489 executor.cc:107] Statement: INSERT INTO default_db_tags VALUES (1, 'test', NULL, 0, 0, 0, 0)
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: planning query
SELECT comments.upvotes, comments.downvotes, comments.story_id FROM comments JOIN stories ON comments.story_id = stories.id WHERE comments.story_id = ? AND comments.user_id != stories.user_id
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: Unoptimized plan
LogicalProject(upvotes=[$9], downvotes=[$10], story_id=[$4])
  LogicalFilter(condition=[AND(=($4, ?0), <>($5, $19))])
    LogicalJoin(condition=[=($4, $17)], joinType=[inner])
      LogicalTableScan(table=[[comments]])
      LogicalTableScan(table=[[stories]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: optimized plan
LogicalProject(upvotes=[$2], downvotes=[$3], story_id=[$0])
  LogicalFilter(condition=[<>($1, $5)])
    LogicalJoin(condition=[=($0, $4)], joinType=[inner])
      LogicalProject(story_id=[$4], user_id=[$5], upvotes=[$9], downvotes=[$10])
        LogicalFilter(condition=[=($4, ?0)])
          LogicalTableScan(table=[[comments]])
      LogicalProject(id=[$0], user_id=[$2])
        LogicalFilter(condition=[=($0, ?0)])
          LogicalTableScan(table=[[stories]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: Added all operators
[
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ] ],
  "output_columns": [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 4 ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ] ],
  "output_columns": [ "story_id","user_id","upvotes","downvotes" ],
 },
 {
"operator": "INPUT", "id": 2, "children": [ 3 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ],
 },
 {
"operator": "PROJECT", "id": 3, "children": [ 4 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","user_id" ],
 },
 {
"operator": "EQUIJOIN", "id": 4, "children": [ 5 ],
  "input_columns": [ [ "story_id","user_id","upvotes","downvotes" ],[ "id","user_id" ] ],
  "output_columns": [ "story_id","user_id","upvotes","downvotes","user_id" ],
 },
 {
"operator": "FILTER", "id": 5, "children": [ 6 ],
  "input_columns": [ [ "story_id","user_id","upvotes","downvotes","user_id" ] ],
  "output_columns": [ "story_id","user_id","upvotes","downvotes","user_id" ],
 },
 {
"operator": "PROJECT", "id": 6, "children": [ 7 ],
  "input_columns": [ [ "story_id","user_id","upvotes","downvotes","user_id" ] ],
  "output_columns": [ "upvotes","downvotes","story_id" ],
 },
 {
"operator": "MAT_VIEW", "id": 7, "children": [ ],
  "input_columns": [ [ "upvotes","downvotes","story_id" ] ],
  "output_columns": [ "upvotes","downvotes","story_id" ],
  "keyed_by": [2],
  "order": "no order",
 },
]
I1213 01:40:07.429106 30489 graph.cc:103] Planned exchanges and partitioning of flow
I1213 01:40:07.429128 30489 graph.cc:104] [
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ] ],
  "output_columns": [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 4 ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ] ],
  "output_columns": [ "story_id","user_id","upvotes","downvotes" ],
 },
 {
"operator": "INPUT", "id": 2, "children": [ 3 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ],
 },
 {
"operator": "PROJECT", "id": 3, "children": [ 4 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","user_id" ],
 },
 {
"operator": "EQUIJOIN", "id": 4, "children": [ 5 ],
  "input_columns": [ [ "story_id","user_id","upvotes","downvotes" ],[ "id","user_id" ] ],
  "output_columns": [ "story_id","user_id","upvotes","downvotes","user_id" ],
 },
 {
"operator": "FILTER", "id": 5, "children": [ 6 ],
  "input_columns": [ [ "story_id","user_id","upvotes","downvotes","user_id" ] ],
  "output_columns": [ "story_id","user_id","upvotes","downvotes","user_id" ],
 },
 {
"operator": "PROJECT", "id": 6, "children": [ 7 ],
  "input_columns": [ [ "story_id","user_id","upvotes","downvotes","user_id" ] ],
  "output_columns": [ "upvotes","downvotes","story_id" ],
 },
 {
"operator": "MAT_VIEW", "id": 7, "children": [ ],
  "input_columns": [ [ "upvotes","downvotes","story_id" ] ],
  "output_columns": [ "upvotes","downvotes","story_id" ],
  "keyed_by": [2],
  "order": "no order",
 },
]
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: planning query
SELECT stories.id, stories.merged_story_id FROM stories WHERE stories.merged_story_id = ?
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: Unoptimized plan
LogicalProject(id=[$0], merged_story_id=[$15])
  LogicalFilter(condition=[=($15, ?0)])
    LogicalTableScan(table=[[stories]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: optimized plan
LogicalProject(id=[$0], merged_story_id=[$15])
  LogicalFilter(condition=[=($15, ?0)])
    LogicalTableScan(table=[[stories]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: Added all operators
[
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","merged_story_id" ],
 },
 {
"operator": "MAT_VIEW", "id": 2, "children": [ ],
  "input_columns": [ [ "id","merged_story_id" ] ],
  "output_columns": [ "id","merged_story_id" ],
  "keyed_by": [1],
  "order": "no order",
 },
]
I1213 01:40:07.444864 30489 graph.cc:103] Planned exchanges and partitioning of flow
I1213 01:40:07.444887 30489 graph.cc:104] [
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","merged_story_id" ],
 },
 {
"operator": "MAT_VIEW", "id": 2, "children": [ ],
  "input_columns": [ [ "id","merged_story_id" ] ],
  "output_columns": [ "id","merged_story_id" ],
  "keyed_by": [1],
  "order": "no order",
 },
]
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: planning query
SELECT comments.*, comments.upvotes - comments.downvotes AS saldo FROM comments WHERE comments.story_id = ? ORDER BY saldo ASC, confidence DESC
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: Unoptimized plan
LogicalSort(sort0=[$17], sort1=[$11], dir0=[ASC], dir1=[DESC])
  LogicalProject(id=[$0], created_at=[$1], updated_at=[$2], short_id=[$3], story_id=[$4], user_id=[$5], parent_comment_id=[$6], thread_id=[$7], comment=[$8], upvotes=[$9], downvotes=[$10], confidence=[$11], markeddown_comment=[$12], is_deleted=[$13], is_moderated=[$14], is_from_email=[$15], hat_id=[$16], saldo=[-($9, $10)])
    LogicalFilter(condition=[=($4, ?0)])
      LogicalTableScan(table=[[comments]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: optimized plan
LogicalSort(sort0=[$17], sort1=[$11], dir0=[ASC], dir1=[DESC])
  LogicalProject(id=[$0], created_at=[$1], updated_at=[$2], short_id=[$3], story_id=[$4], user_id=[$5], parent_comment_id=[$6], thread_id=[$7], comment=[$8], upvotes=[$9], downvotes=[$10], confidence=[$11], markeddown_comment=[$12], is_deleted=[$13], is_moderated=[$14], is_from_email=[$15], hat_id=[$16], saldo=[-($9, $10)])
    LogicalFilter(condition=[=($4, ?0)])
      LogicalTableScan(table=[[comments]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: Added all operators
[
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ] ],
  "output_columns": [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ] ],
  "output_columns": [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id","saldo" ],
 },
 {
"operator": "MAT_VIEW", "id": 2, "children": [ ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id","saldo" ] ],
  "output_columns": [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id","saldo" ],
  "keyed_by": [4],
  "order": "Record ordered",
 },
]
I1213 01:40:07.494383 30489 graph.cc:103] Planned exchanges and partitioning of flow
I1213 01:40:07.494405 30489 graph.cc:104] [
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ] ],
  "output_columns": [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id" ] ],
  "output_columns": [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id","saldo" ],
 },
 {
"operator": "MAT_VIEW", "id": 2, "children": [ ],
  "input_columns": [ [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id","saldo" ] ],
  "output_columns": [ "id","created_at","updated_at","short_id","story_id","user_id","parent_comment_id","thread_id","comment","upvotes","downvotes","confidence","markeddown_comment","is_deleted","is_moderated","is_from_email","hat_id","saldo" ],
  "keyed_by": [4],
  "order": "Record ordered",
 },
]
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: planning query
SELECT tags.*, taggings.story_id FROM tags INNER JOIN taggings ON tags.id = taggings.tag_id WHERE taggings.story_id = ?
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: Unoptimized plan
LogicalProject(id=[$0], tag=[$1], description=[$2], privileged=[$3], is_media=[$4], inactive=[$5], hotness_mod=[$6], story_id=[$8])
  LogicalFilter(condition=[=($8, ?0)])
    LogicalJoin(condition=[=($0, $9)], joinType=[inner])
      LogicalTableScan(table=[[tags]])
      LogicalTableScan(table=[[taggings]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: optimized plan
LogicalProject(id=[$0], tag=[$1], description=[$2], privileged=[$3], is_media=[$4], inactive=[$5], hotness_mod=[$6], story_id=[$7])
  LogicalJoin(condition=[=($0, $8)], joinType=[inner])
    LogicalProject(id=[$0], tag=[$1], description=[$2], privileged=[$3], is_media=[$4], inactive=[$5], hotness_mod=[$6])
      LogicalTableScan(table=[[tags]])
    LogicalProject(story_id=[$1], tag_id=[$2])
      LogicalFilter(condition=[=($1, ?0)])
        LogicalTableScan(table=[[taggings]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: Added all operators
[
 {
"operator": "INPUT", "id": 0, "children": [ 3 ],
  "input_columns": [ [ "id","tag","description","privileged","is_media","inactive","hotness_mod" ] ],
  "output_columns": [ "id","tag","description","privileged","is_media","inactive","hotness_mod" ],
 },
 {
"operator": "INPUT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","story_id","tag_id" ] ],
  "output_columns": [ "id","story_id","tag_id" ],
 },
 {
"operator": "PROJECT", "id": 2, "children": [ 3 ],
  "input_columns": [ [ "id","story_id","tag_id" ] ],
  "output_columns": [ "story_id","tag_id" ],
 },
 {
"operator": "EQUIJOIN", "id": 3, "children": [ 4 ],
  "input_columns": [ [ "id","tag","description","privileged","is_media","inactive","hotness_mod" ],[ "story_id","tag_id" ] ],
  "output_columns": [ "id","tag","description","privileged","is_media","inactive","hotness_mod","story_id" ],
 },
 {
"operator": "PROJECT", "id": 4, "children": [ 5 ],
  "input_columns": [ [ "id","tag","description","privileged","is_media","inactive","hotness_mod","story_id" ] ],
  "output_columns": [ "id","tag","description","privileged","is_media","inactive","hotness_mod","story_id" ],
 },
 {
"operator": "MAT_VIEW", "id": 5, "children": [ ],
  "input_columns": [ [ "id","tag","description","privileged","is_media","inactive","hotness_mod","story_id" ] ],
  "output_columns": [ "id","tag","description","privileged","is_media","inactive","hotness_mod","story_id" ],
  "keyed_by": [7],
  "order": "no order",
 },
]
I1213 01:40:07.510991 30489 graph.cc:103] Planned exchanges and partitioning of flow
I1213 01:40:07.511014 30489 graph.cc:104] [
 {
"operator": "INPUT", "id": 0, "children": [ 3 ],
  "input_columns": [ [ "id","tag","description","privileged","is_media","inactive","hotness_mod" ] ],
  "output_columns": [ "id","tag","description","privileged","is_media","inactive","hotness_mod" ],
 },
 {
"operator": "INPUT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","story_id","tag_id" ] ],
  "output_columns": [ "id","story_id","tag_id" ],
 },
 {
"operator": "PROJECT", "id": 2, "children": [ 3 ],
  "input_columns": [ [ "id","story_id","tag_id" ] ],
  "output_columns": [ "story_id","tag_id" ],
 },
 {
"operator": "EQUIJOIN", "id": 3, "children": [ 4 ],
  "input_columns": [ [ "id","tag","description","privileged","is_media","inactive","hotness_mod" ],[ "story_id","tag_id" ] ],
  "output_columns": [ "id","tag","description","privileged","is_media","inactive","hotness_mod","story_id" ],
 },
 {
"operator": "PROJECT", "id": 4, "children": [ 6 ],
  "input_columns": [ [ "id","tag","description","privileged","is_media","inactive","hotness_mod","story_id" ] ],
  "output_columns": [ "id","tag","description","privileged","is_media","inactive","hotness_mod","story_id" ],
 },
 {
"operator": "MAT_VIEW", "id": 5, "children": [ ],
  "input_columns": [ [ "id","tag","description","privileged","is_media","inactive","hotness_mod","story_id" ] ],
  "output_columns": [ "id","tag","description","privileged","is_media","inactive","hotness_mod","story_id" ],
  "keyed_by": [7],
  "order": "no order",
 },
 {
"operator": "EXCHANGE", "id": 6, "children": [ 5 ],
  "input_columns": [ [ "id","tag","description","privileged","is_media","inactive","hotness_mod","story_id" ] ],
  "output_columns": [ "id","tag","description","privileged","is_media","inactive","hotness_mod","story_id" ],
  "outkey": [7],
 },
]
I1213 01:40:07.511363 30489 executor.cc:59] Shard: default
I1213 01:40:07.511376 30489 executor.cc:107] Statement: SELECT * FROM default_db_tags
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: planning query
SELECT stories.* FROM stories WHERE stories.merged_story_id IS NULL AND stories.is_expired = 0 AND stories.upvotes - stories.downvotes >= 0 ORDER BY hotness ASC LIMIT 51
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: Unoptimized plan
LogicalSort(sort0=[$11], dir0=[ASC], fetch=[51])
  LogicalProject(id=[$0], created_at=[$1], user_id=[$2], url=[$3], title=[$4], description=[$5], short_id=[$6], is_expired=[$7], upvotes=[$8], downvotes=[$9], is_moderated=[$10], hotness=[$11], markeddown_description=[$12], story_cache=[$13], comments_count=[$14], merged_story_id=[$15], unavailable_at=[$16], twitter_id=[$17], user_is_author=[$18])
    LogicalFilter(condition=[AND(IS NULL($15), =($7, 0), >=(-($8, $9), 0))])
      LogicalTableScan(table=[[stories]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: optimized plan
LogicalSort(sort0=[$11], dir0=[ASC], fetch=[51])
  LogicalProject(id=[$0], created_at=[$1], user_id=[$2], url=[$3], title=[$4], description=[$5], short_id=[$6], is_expired=[$7], upvotes=[$8], downvotes=[$9], is_moderated=[$10], hotness=[$11], markeddown_description=[$12], story_cache=[$13], comments_count=[$14], merged_story_id=[$15], unavailable_at=[$16], twitter_id=[$17], user_is_author=[$18])
    LogicalFilter(condition=[AND(IS NULL($15), =($7, 0), >=(-($8, $9), 0))])
      LogicalTableScan(table=[[stories]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: Added all operators
[
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author","_PELTON_TMP_20" ],
 },
 {
"operator": "FILTER", "id": 2, "children": [ 3 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author","_PELTON_TMP_20" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author","_PELTON_TMP_20" ],
 },
 {
"operator": "PROJECT", "id": 3, "children": [ 4 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author","_PELTON_TMP_20" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ],
 },
 {
"operator": "MAT_VIEW", "id": 4, "children": [ ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ],
  "keyed_by": [],
  "order": "Record ordered",
 },
]
I1213 01:40:07.534441 30489 graph.cc:103] Planned exchanges and partitioning of flow
I1213 01:40:07.534462 30489 graph.cc:104] [
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ],
 },
 {
"operator": "PROJECT", "id": 1, "children": [ 2 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author","_PELTON_TMP_20" ],
 },
 {
"operator": "FILTER", "id": 2, "children": [ 3 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author","_PELTON_TMP_20" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author","_PELTON_TMP_20" ],
 },
 {
"operator": "PROJECT", "id": 3, "children": [ 4 ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author","_PELTON_TMP_20" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ],
 },
 {
"operator": "MAT_VIEW", "id": 4, "children": [ ],
  "input_columns": [ [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ] ],
  "output_columns": [ "id","created_at","user_id","url","title","description","short_id","is_expired","upvotes","downvotes","is_moderated","hotness","markeddown_description","story_cache","comments_count","merged_story_id","unavailable_at","twitter_id","user_is_author" ],
  "keyed_by": [],
  "order": "Record ordered",
 },
]
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: planning query
SELECT votes.* FROM votes WHERE votes.comment_id = ?
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: Unoptimized plan
LogicalProject(id=[$0], OWNER_user_id=[$1], story_id=[$2], comment_id=[$3], vote=[$4], reason=[$5])
  LogicalFilter(condition=[=($3, ?0)])
    LogicalTableScan(table=[[votes]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: optimized plan
LogicalProject(id=[$0], OWNER_user_id=[$1], story_id=[$2], comment_id=[$3], vote=[$4], reason=[$5])
  LogicalFilter(condition=[=($3, ?0)])
    LogicalTableScan(table=[[votes]])

Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: Added all operators
[
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","OWNER_user_id","story_id","comment_id","vote","reason" ] ],
  "output_columns": [ "id","OWNER_user_id","story_id","comment_id","vote","reason" ],
 },
 {
"operator": "MAT_VIEW", "id": 1, "children": [ ],
  "input_columns": [ [ "id","OWNER_user_id","story_id","comment_id","vote","reason" ] ],
  "output_columns": [ "id","OWNER_user_id","story_id","comment_id","vote","reason" ],
  "keyed_by": [3],
  "order": "no order",
 },
]
I1213 01:40:07.544049 30489 graph.cc:103] Planned exchanges and partitioning of flow
I1213 01:40:07.544070 30489 graph.cc:104] [
 {
"operator": "INPUT", "id": 0, "children": [ 1 ],
  "input_columns": [ [ "id","OWNER_user_id","story_id","comment_id","vote","reason" ] ],
  "output_columns": [ "id","OWNER_user_id","story_id","comment_id","vote","reason" ],
 },
 {
"operator": "MAT_VIEW", "id": 1, "children": [ ],
  "input_columns": [ [ "id","OWNER_user_id","story_id","comment_id","vote","reason" ] ],
  "output_columns": [ "id","OWNER_user_id","story_id","comment_id","vote","reason" ],
  "keyed_by": [3],
  "order": "no order",
 },
]
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner plan
INFO: planning query
SELECT tags.id, stories.user_id, count(*) AS `count` FROM tags INNER JOIN taggings ON tags.id = taggings.tag_id INNER JOIN stories ON taggings.story_id = stories.id WHERE tags.inactive = 0 AND stories.user_id = ? GROUP BY tags.id, stories.user_id ORDER BY `count` DESC LIMIT 1
Dec 13, 2021 1:40:07 AM com.brownsys.pelton.QueryPlanner getPhysicalPlan
INFO: Unoptimized plan
LogicalSort(sort0=[$2], dir0=[DESC], fetch=[1])
  LogicalAggregate(group=[{0, 1}], count=[COUNT()])
    LogicalProject(id=[$0], user_id=[$12])
      LogicalFilter(condition=[AND(=($5, 0), =($12, ?0))])
        LogicalJoin(condition=[=($8, $10)], joinType=[inner])
          LogicalJoin(condition=[=($0, $9)], joinType=[inner])
            LogicalTableScan(table=[[tags]])
            LogicalTableScan(table=[[taggings]])
          LogicalTableScan(table=[[stories]])

pthread lock: Invalid argument
