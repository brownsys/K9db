CREATE VIEW replying_comments_for_count AS '"SELECT read_ribbons.user_id, read_ribbons.story_id, comments.id FROM read_ribbons JOIN stories ON (stories.id = read_ribbons.story_id) JOIN comments ON (comments.story_id = read_ribbons.story_id) LEFT JOIN comments AS parent_comments ON (parent_comments.id = comments.parent_comment_id) WHERE read_ribbons.is_following = 1 AND comments.user_id <> read_ribbons.user_id AND comments.is_deleted = 0 AND comments.is_moderated = 0 AND ( comments.upvotes - comments.downvotes ) >= 0 AND read_ribbons.updated_at < comments.created_at AND ( ( parent_comments.user_id = read_ribbons.user_id AND ( parent_comments.upvotes - parent_comments.downvotes ) >= 0 ) OR ( parent_comments.id IS NULL AND stories.user_id = read_ribbons.user_id))"';
CREATE VIEW q29 AS '"SELECT replying_comments_for_count.user_id, count(*) AS notifications FROM replying_comments_for_count WHERE replying_comments_for_count.user_id = 0"';
SELECT * FROM q29;
